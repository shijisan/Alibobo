datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id               Int       @id @default(autoincrement())
  username         String    @unique
  email            String    @unique
  phoneNumber      String
  password         String
  role             Role      @default(BUYER) // Default role set to BUYER
  profilePicture   String?   // Optional profile picture
  seller           Seller?   // One-to-one relation with seller (optional)
  admin            Admin?    // One-to-one relation with admin
  images           Image[]   // One-to-many relation with images
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
}

model Seller {
  id              Int     @id @default(autoincrement())
  user            User    @relation(fields: [userId], references: [id])
  userId          Int     @unique
  shopName        String
  shopDescription String?
  shopProfilePic  String? // Optional shop profile picture
  idImage         String  // ID image required for verification
  verified        Boolean @default(false) // To be updated by admin
  products        Product[]
}

model Admin {
  id         Int      @id @default(autoincrement())
  user       User     @relation(fields: [userId], references: [id])
  userId     Int      @unique
  role       String   @default("admin")
}

model Product {
  id          Int       @id @default(autoincrement())
  seller      Seller    @relation(fields: [sellerId], references: [id])
  sellerId    Int
  name        String
  description String?
  price       Float
  stock       Int
  images      Image[]   // One-to-many relation with Image table
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Image {
  id        Int      @id @default(autoincrement())
  imageUrl  String
  product   Product? @relation(fields: [productId], references: [id])
  productId Int?
  user      User?    @relation(fields: [userId], references: [id])
  userId    Int?
}

enum Role {
  BUYER
  SELLER
  ADMIN
}
